import{u as B,ac as N,a as S,m as C,aG as $,S as x,aH as R,o as i,c as u,b as a,w as n,V as D,d as p,e as I,h as t,R as T,aI as j,aJ as z,af as o,$ as f,i as d,j as c,aK as A,ag as E}from"./index.1db97491.js";import{V as F}from"./VTable.70c892cd.js";const G={id:"cart"},H=t("h1",{class:"text-center"},"\u8CFC\u7269\u8ECA",-1),J=t("thead",null,[t("tr",null,[t("th",null,"\u5716\u7247"),t("th",null,"\u540D\u7A31"),t("th",null,"\u55AE\u50F9"),t("th",null,"\u6578\u91CF"),t("th",null,"\u5C0F\u8A08"),t("th",null,"\u64CD\u4F5C")])],-1),K={key:0},L=t("td",{class:"text",colspan:"6"},"\u6C92\u6709\u5546\u54C1",-1),P=[L],Q={__name:"CartView",setup(U){const k=B(),y=N(),{editCart:V,checkout:v}=y,s=S([]),_=async(e,r)=>{await V({_id:s[e].p_id._id,quantity:r}),s[e].quantity+=r,s[e].quantity<=0&&s.splice(e,1)},g=async()=>{await v(),k.push("/orders")},w=C(()=>s.reduce((e,r)=>e+r.p_id.price*r.quantity,0)),b=C(()=>s.length>0&&!s.some(e=>!e.p_id.sell));return(async()=>{try{const{data:e}=await $.get("/users/cart");s.push(...e.result)}catch{x.fire({icon:"error",title:"\u5931\u6557",text:"\u53D6\u5F97\u8CFC\u7269\u8ECA\u5931\u6557"})}})(),(e,r)=>{const q=R("v-divier");return i(),u("div",G,[a(D,null,{default:n(()=>[a(p,{cols:"12"},{default:n(()=>[H]),_:1}),a(I),a(p,{cols:"12"},{default:n(()=>[a(F,null,{default:n(()=>[J,t("tbody",null,[(i(!0),u(T,null,j(s,(l,h)=>(i(),u("tr",{key:l._id,class:A({"bg-red":!l.p_id.sell})},[t("td",null,[a(E,{"aspect-ratio":1,width:200,src:l.p_id.image},null,8,["src"])]),t("td",null,o(l.p_id.name),1),t("td",null,o(l.p_id.price),1),t("td",null,[a(d,{color:"primary",onClick:m=>_(h,-1)},{default:n(()=>[c("-")]),_:2},1032,["onClick"]),c("\xA0"+o(l.quantity)+"\xA0",1),a(d,{color:"primary",onClick:m=>_(h,1)},{default:n(()=>[c("+")]),_:2},1032,["onClick"])]),t("td",null,o(l.quantity*l.p_id.price),1),t("td",null,[a(d,{color:"red",onClick:m=>_(h,l.quantity*-1)},{default:n(()=>[c("\u522A\u9664")]),_:2},1032,["onClick"])])],2))),128)),s.length===0?(i(),u("tr",K,P)):z("",!0)])]),_:1})]),_:1}),a(q),a(p,{class:"text-center",cols:"12"}),t("p",null,"\u7E3D\u91D1\u984D "+o(f(w)),1),a(d,{color:"green",disabled:!f(b),onClick:g},{default:n(()=>[c("\u7D50\u5E33")]),_:1},8,["disabled"])]),_:1})])}}};export{Q as default};
